<html>
<head>
  <title>ELP Server</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
</head>
<body>
  <div>
    <nav class="navbar navbar-inverse navbar-static-top">
      <div class="container">
        <a class="navbar-brand" href="/">ELP Server</a>
      </div>
    </nav>
    <div class="jumbotron"  style="padding:40px;">
      <h3>Public API:</h3>
      <table class="table table-bordered table-hover">
        <thead>
          <tr>
            <th>Method</th>
            <th>API:</th>
            <th>Params</th>
            <th>Returns</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          
          <tr>
            <td>POST</td>
            <td>/api/signup</td>
            <td>
              USER
              <code>
              {<br>
                username:         {type: String, required: true},<br>
                email:            {type: String, required: true},<br>
                password:         {type: String, required: true},<br>
                registrationTime: {type: Date, default: Date.now},<br>
                registrationType: String,<br>
                accountType:      String,<br>
                location:         Schema.Types.Mixed,<br>
                map:              String<br>
              }
              </code>

            </td>
            <td>
              <code>
                {<br>
                  user: USER<br>
                  success: boolean,<br>
                  message: string,<br>
                  token<br>
                }
              </code>
            </td>
            <td>
              Creates User
            </td>
          </tr>

          <tr>
            <td>POST</td>
            <td>/api/login</td>
            <td>
              <code>
              {<br>
                username:         {type: String, required: true},<br>
                password:         {type: String, required: true},<br>
              }
              </code>
            </td>
            <td>
              <code>
                {<br>
                  success: boolean,<br>
                  message: string,<br>
                  token<br>
                }
              </code>
            </td>
            <td>
              Login
            </td>
          </tr>

          <tr>
            <td colspan=5 style='background-color: #008080; font-weight: 700;'>Next requests should be made with token!</td>
          </tr>

          <tr>
            <td>GET</td>
            <td>/api/users</td>
            <td>
              <code>
              /
              </code>
            </td>
            <td>
              <code>
              [{_id: ObjectID,<br> username: string,<br> email: string,<br> registrationTime: Date},<br> ...]
              </code>
            </td>
            <td>
              Returns array of all users
            </td>
          </tr>
          <tr>
            <td>POST</td>
            <td>/api/upload</td>
            <td>
              <code>
              File should be uploaded
              </code>
            </td>
            <td>
              <code>
                {<br>
                  success: boolean,<br>
                  message: string<br>
                }
              </code>
            </td>
            <td>
            </td>
          </tr>

          <tr>
            <td>DELETE</td>
            <td>/api/user/:id</td>
            <td>
              <code>
              { _id: ObjectID }
              </code>
            </td>
            <td>
              <code>
                {<br>
                  success: boolean,<br>
                  id: user._id<br>
                }
              </code>
            </td>
            <td>
            </td>
          </tr>

          <tr>
            <td colspan=5 style='background-color: lightblue; font-weight: 700;'>TODO Api:</td>
          </tr>

          <tr>
            <td>POST</td>
            <td>/api/is-admin</td>
            <td>
              <code>
              { user: USER }
              </code>
            </td>
            <td>
              sucess:<br>
              <code>
                {<br>
                  massage: 'User ${email} has admin rights', <br />
                  userFound: true,<br>
                  isAdmin: true<br>
                }<br>
              </code>
              fail:<br>
              <code>
                {<br>
                  mesage: 'User is not admin', <br />
                  userFound: true,<br>
                  isAdmin: false<br>
                }<br>
              </code>
              user not fund:<br>
              <code>
                {<br>
                  errorMsg: 'User not found', <br />
                  userFound: false,<br>
                  isAdmin: false<br>
                }
              </code>
            </td>
            <td>
              <p>
                Should find the user in users table and check if
                user.type === 'admin'

                also for security we can compare user password and emails provided from request
              </p>
            </td>
          </tr>

          <tr>
            <td>POST</td>
            <td>/api/send-recovery-pass-email</td>
            <td>
              <code>
              { email: email }
              </code>
            </td>
            <td>
              sucess:
              <code>
                {<br>
                  message: 'Recovery pass email sent',<br />
                  userFound: true,<br>
                  sent: true,<br>
                }<br>
              </code>
              fail:<br>
              <code>
                {<br>
                  errorMsg: 'User not found'<br />
                  userFound: false,<br>
                  sent: false,<br>
                }<br>
              </code>
              error sending email:<br>
              <code>
                {<br>
                  errorMsg: 'error sending email'<br />
                  userFound: true,<br>
                  sent: false,<br>
                }
              </code>
            </td>
            <td>
              <p>
              should find the user with provided email, and send him a email with
              password reset link

              TODO: crate email on backend side, reset password functinalliy on fron end
              </p>
            </td>
          </tr>

          <tr>
            <td>
              POST
            </td>
            <td>
              /api/quick-email
            </td>
            <td>
              <code>
                {<br>
                  date: DateTime,<br>
                  email: string,<br>
                  ip: number<br>
                  route: string<br>
                }
              </code>
            </td>
            <td>
              sucess:<br>
              <code>
                {<br>
                  message: 'email sent',<br>
                  sent: false,<br>
                }<br>
              </code>
              error sending email:<br>
              <code>
                {<br>
                  errorMsg: 'Failed sending email',<br>
                  userFound: true,<br>
                  sent: false,<br>
                }<br>
              </code>
            </td>
            <td>
              efter receiving quick-email request back-end should store the data in DB,
              send an email on the email provided in the request,
              send email to each admin user

              example of email to the who made the request:

              <div>
                <h3>Thank you for your request</h3>
                <p>
                  We will contact you within next 3 hours
                </p>
                {{TODO: some footer here}}
              </div>
            </td>
          </tr>

        </tbody>
      </table>
    </div>
  </div>

  <div>
    <h2>Try with curl:</h2>
    <p><strong>GET:</strong><br>
    <code>curl http://localhost:9999/api/users</code>
    </p>
    <p><strong>POST:</strong><br>
    <code>curl -d username=Rosty -d email=Rosty@gmail.com -d password=rosty123 http://localhost:9999/api/signup</code>
    </p>

    <p>
    <h4><i>Set token:</i></h4>
    <code>curl -H "x-access-token: &lt;token goes here&gt;" http://localhost:9999</code>
    </p>

    <h4>Following requests only with token:</h4>
    <p>
    <strong>Upload file:</strong> <br>
    <code>curl -F name=someName -F file=@README.md  http://localhost:9999/api/upload</code><br>
    <strong>DELETE:</strong> <br>
    <code>curl -X DELETE http://localhost:9999/api/user/58d19e770bf1c112486b</code>
    </p>
  </div>
</body>
</html>
